{% extends 'base.html' %}
{% block content %}
<div class="container mt-5">
  <div class="card shadow-lg border-0 rounded-4 p-4">
    <div class="row g-4 align-items-center">

      <!-- Artwork Image -->
      <div class="col-md-6 text-center">
        {% if art.image_filename %}
        <img src="{{ url_for('uploaded_file', filename=art.image_filename) }}" 
             class="img-fluid rounded-4 shadow-sm"
             style="max-height: 450px; object-fit: cover;">
        {% else %}
        <div class="bg-light d-flex align-items-center justify-content-center rounded-3" style="height: 450px;">
          <p class="text-muted">No image available</p>
        </div>
        {% endif %}
      </div>

      <!-- Artwork Info -->
      <div class="col-md-6">
        <h2 class="fw-bold mb-2 text-primary">{{ art.title }}</h2>
        <p class="text-muted mb-1">
          By <strong>{{ art.artist_name or 'Unknown Artist' }}</strong>
        </p>

        <!-- ‚≠ê Average Rating -->
        {% if rating_info.avg_rating %}
          <p class="fw-semibold text-warning mb-2">
            ‚≠ê {{ "%.1f"|format(rating_info.avg_rating) }}/5
            <span class="text-muted">({{ rating_info.total_reviews }} reviews)</span>
          </p>
        {% else %}
          <p class="text-muted mb-2">No reviews yet</p>
        {% endif %}

        <hr>

        <p class="lead">{{ art.description }}</p>
        <h4 class="fw-bold text-success mt-3">‚Çπ {{ art.price }}</h4>

        <!-- Quantity -->
        <p class="mt-3">
          {% if art.available_qty > 0 %}
            <strong>Available Quantity:</strong> {{ art.available_qty }}
          {% else %}
            <strong>Status:</strong> <span class="badge bg-danger">Sold Out</span>
          {% endif %}
        </p>

        <!-- Status badge -->
        <p>
          Status:
          {% if art.available_qty == 0 %}
            <span class="badge bg-danger">Sold</span>
          {% else %}
            <span class="badge bg-success">Available</span>
          {% endif %}
        </p>

        <!-- Buy Button -->
        {% if art.available_qty > 0 %}
        <form action="{{ url_for('add_to_cart', artwork_id=art.artwork_id) }}" method="post" class="mt-3">
          <input type="hidden" name="quantity" value="1">
          <button class="btn btn-lg btn-gradient w-100 text-white">
            üõí Add to Cart
          </button>
        </form>
        {% else %}
          <button class="btn btn-secondary btn-lg w-100 mt-3" disabled>
            Sold Out
          </button>
        {% endif %}

        <!-- Back Button -->
        <a href="{{ url_for('index') }}" class="btn btn-outline-dark mt-4 w-100">
          ‚Üê Back to Gallery
        </a>
      </div>
    </div>
  </div>

  <!-- üó£Ô∏è REVIEWS SECTION -->
  <div class="mt-5">
    <h4 class="fw-bold mb-3">Customer Reviews</h4>

    {% if reviews %}
      {% for r in reviews %}
        <div class="border rounded-3 p-3 mb-3 shadow-sm">
          <div class="d-flex justify-content-between">
            <strong>{{ r.username }}</strong>
            <span class="text-warning">
              {% for i in range(r.rating) %}‚≠ê{% endfor %}
            </span>
          </div>
          <p class="mb-1 mt-2">{{ r.comment }}</p>
          <small class="text-muted">{{ r.created_at }}</small>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-muted">No reviews yet for this artwork.</p>
    {% endif %}
  </div>
</div>

<!-- Gradient Button Style -->
<style>
.btn-gradient {
  background: linear-gradient(90deg, #00c6ff, #0072ff);
  border: none;
  transition: 0.3s;
}
.btn-gradient:hover {
  background: linear-gradient(90deg, #0072ff, #00c6ff);
  transform: scale(1.02);
}
</style>
{% endblock %}
